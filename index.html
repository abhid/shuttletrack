<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="apple-icon.png" />

    <title>DTA &middot; Downtown Shuttle Tracker</title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js" charset="utf-8"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.12.3/semantic.min.js" charset="utf-8"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js" charset="utf-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.10.3/moment.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/1.12.3/semantic.min.css" media="screen" charset="utf-8">
  </head>

  <body style="padding-top:15px;">
    <div class="ui padded centered grid">
      <div class="sixteen wide column middle aligned">
        <div class = "ui menu compact">
          <a class = "active item">To Downtown</a>
          <a class = "item">From Downtown</a>
        </div>
      </div>
      <div class ="sixteen wide column middle aligned">
          The next shuttle leaves the <b class="start-location"></b> at <p><h2 class="next-shuttle-start-time">00:00 PM</h2></p> and arrives at the <span class="end-location"></span> at <span class="next-shuttle-end-time">00:00 PM</span>
      </div>
      <div class = "sixteen wide column middle aligned">
        Next 5 shuttles from the <span class="start-location"></span> leave at
        <p class="future-shuttles">
        </p>
      </div>
      <div class=" sixteen wide column middle aligned">

        <div class="ui divider">
        </div>
        made with <i class="code icon"></i> in duluth, mn
        |
        <a href="http://devireddy.com" target="_blank">abhi devireddy</a>
      </div>
    </div>
    <script type="text/javascript">
      var toDowntown = [
        {
          "start":"0550",
          "end":"0557"
        },
        {
          "start":"0605",
          "end":"0612"
        },
        {
          "start":"0620",
          "end":"0627"
        },
        {
          "start":"0635",
          "end":"0642"
        },
        {
          "start":"0646",
          "end":"0653"
        },
        {
          "start":"0652",
          "end":"0659"
        },
        {
          "start":"0702",
          "end":"0709"
        },
        {
          "start":"0710",
          "end":"0717"
        },
        {
          "start":"0718",
          "end":"0725"
        },
        {
          "start":"0726",
          "end":"0733"
        },
        {
          "start":"0734",
          "end":"0741"
        },
        {
          "start":"0742",
          "end":"0749"
        },
        {
          "start":"0750",
          "end":"0757"
        },
        {
          "start":"0758",
          "end":"0805"
        },
        {
          "start":"0806",
          "end":"0813"
        },
        {
          "start":"0814",
          "end":"0821"
        },
        {
          "start":"0822",
          "end":"0829"
        },
        {
          "start":"0830",
          "end":"0837"
        },
        {
          "start":"0838",
          "end":"0845"
        },
        {
          "start":"0856",
          "end":"0903"
        },
        {
          "start":"0916",
          "end":"0923"
        },
        {
          "start":"0936",
          "end":"0943"
        },
        {
          "start":"0956",
          "end":"1003"
        },
        {
          "start":"1016",
          "end":"1023"
        },
        {
          "start":"1036",
          "end":"1043"
        },
        {
          "start":"1056",
          "end":"1103"
        },
        {
          "start":"1116",
          "end":"1123"
        },
        {
          "start":"1136",
          "end":"1143"
        },
        {
          "start":"1156",
          "end":"1203"
        },
        {
          "start":"1216",
          "end":"1223"
        },
        {
          "start":"1236",
          "end":"1243"
        },
        {
          "start":"1256",
          "end":"1303"
        },
        {
          "start":"1319",
          "end":"1326"
        },
        {
          "start":"1339",
          "end":"1346"
        },
        {
          "start":"1359",
          "end":"1406"
        },
        {
          "start":"1419",
          "end":"1426"
        },
        {
          "start":"1439",
          "end":"1446"
        },
        {
          "start":"1459",
          "end":"1506"
        },
        {
          "start":"1519",
          "end":"1526"
        },
        {
          "start":"1529",
          "end":"1536"
        },
        {
          "start":"1539",
          "end":"1546"
        },
        {
          "start":"1549",
          "end":"1556"
        },
        {
          "start":"1559",
          "end":"1606"
        },
        {
          "start":"1609",
          "end":"1616"
        },
        {
          "start":"1619",
          "end":"1626"
        },
        {
          "start":"1629",
          "end":"1636"
        },
        {
          "start":"1639",
          "end":"1646"
        },
        {
          "start":"1649",
          "end":"1656"
        },
        {
          "start":"1659",
          "end":"1706"
        },
        {
          "start":"1707",
          "end":"1714"
        },
        {
          "start":"1713",
          "end":"1720"
        },
        {
          "start":"1723",
          "end":"1730"
        },
        {
          "start":"1739",
          "end":"1746"
        },
        {
          "start":"1755",
          "end":"1802"
        },
        {
          "start":"1811",
          "end":"1818"
        },
        {
          "start":"1825",
          "end":"1832"
        }
      ]

      var fromDowntown = [
        {
          "start":"0557",
          "end":"0604"
        },
        {
          "start":"0612",
          "end":"0619"
        },
        {
          "start":"0627",
          "end":"0634"
        },
        {
          "start":"0642",
          "end":"0649"
        },
        {
          "start":"0653",
          "end":"0700"
        },
        {
          "start":"0659",
          "end":"0706"
        },
        {
          "start":"0709",
          "end":"0716"
        },
        {
          "start":"0717",
          "end":"0724"
        },
        {
          "start":"0725",
          "end":"0732"
        },
        {
          "start":"0733",
          "end":"0740"
        },
        {
          "start":"0741",
          "end":"0748"
        },
        {
          "start":"0749",
          "end":"0756"
        },
        {
          "start":"0757",
          "end":"0804"
        },
        {
          "start":"0805",
          "end":"0812"
        },
        {
          "start":"0813",
          "end":"0820"
        },
        {
          "start":"0821",
          "end":"0828"
        },
        {
          "start":"0829",
          "end":"0836"
        },
        {
          "start":"0845",
          "end":"0852"
        },
        {
          "start":"0903",
          "end":"0910"
        },
        {
          "start":"0923",
          "end":"0930"
        },
        {
          "start":"0943",
          "end":"0950"
        },
        {
          "start":"1003",
          "end":"1010"
        },
        {
          "start":"1023",
          "end":"1030"
        },
        {
          "start":"1043",
          "end":"1050"
        },
        {
          "start":"1103",
          "end":"1110"
        },
        {
          "start":"1123",
          "end":"1130"
        },
        {
          "start":"1143",
          "end":"1150"
        },
        {
          "start":"1203",
          "end":"1210"
        },
        {
          "start":"1223",
          "end":"1230"
        },
        {
          "start":"1243",
          "end":"1250"
        },
        {
          "start":"1303",
          "end":"1310"
        },
        {
          "start":"1326",
          "end":"1333"
        },
        {
          "start":"1346",
          "end":"1353"
        },
        {
          "start":"1406",
          "end":"1413"
        },
        {
          "start":"1426",
          "end":"1433"
        },
        {
          "start":"1446",
          "end":"1453"
        },
        {
          "start":"1506",
          "end":"1513"
        },
        {
          "start":"1516",
          "end":"1523"
        },
        {
          "start":"1526",
          "end":"1533"
        },
        {
          "start":"1536",
          "end":"1543"
        },
        {
          "start":"1546",
          "end":"1553"
        },
        {
          "start":"1556",
          "end":"1603"
        },
        {
          "start":"1606",
          "end":"1613"
        },
        {
          "start":"1616",
          "end":"1623"
        },
        {
          "start":"1626",
          "end":"1633"
        },
        {
          "start":"1636",
          "end":"1643"
        },
        {
          "start":"1646",
          "end":"1653"
        },
        {
          "start":"1656",
          "end":"1703"
        },
        {
          "start":"1706",
          "end":"1713"
        },
        {
          "start":"1714",
          "end":"1721"
        },
        {
          "start":"1730",
          "end":"1737"
        },
        {
          "start":"1746",
          "end":"1753"
        },
        {
          "start":"1802",
          "end":"1809"
        },
        {
          "start":"1818",
          "end":"1825"
        }
      ]
      $(".ui.menu a").click(function() {
        $(".ui.menu .active").removeClass("active");
        $(this).addClass("active");
        refreshData()
      });

      var refreshData = function() {
        // Set next_shuttles based on which link is selected
        var next_shuttles;
        if ($(".ui.menu .active").text() == "To Downtown") {
          $(".start-location").text("DECC");
          $(".end-location").text("Holiday Center");
          next_shuttles = _.filter(toDowntown, function(shuttle) { return moment(shuttle["start"], "hhmm") > moment()});
          if (_.size(next_shuttles) == 0) {
            next_shuttles = toDowntown.slice(0, 6)
          }
          console.log("Going Downtown")
        }
        else {
          $(".start-location").text("Holiday Center");
          $(".end-location").text("DECC");
          next_shuttles = _.filter(fromDowntown, function(shuttle) { return moment(shuttle["start"], "hhmm") > moment()});
          console.log("Going to the DECC")
          if (_.size(next_shuttles) == 0) {
            next_shuttles = fromDowntown.slice(0, 6)
          }
        }

        $(".next-shuttle-start-time").text(moment(next_shuttles[0]["start"], "hhmm").format("hh:mm A"));
        $(".next-shuttle-end-time").text(moment(next_shuttles[0]["end"], "hhmm").format("hh:mm A"));
        $(".future-shuttles").text("");
        _.each(next_shuttles, function(value, key, list) {if (key > 0 && key < 6) {
          $(".future-shuttles").append("<div class='ui label' style='margin-top: 5px;'>" + moment(value["start"], "hhmm").format("hh:mm A") + "</div>");
        }})
      }
      refreshData();
    </script>
  </body>
</html>
